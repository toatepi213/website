;/*FB_PKG_DELIM*/

__d("LSAddMessengerContact",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("contact_id",a[0]),d[1]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTask"),"add_messenger_contact",c.i64.cast([0,308]),d[1],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSAddMessengerContactStoredProcedure",["LSAddMessengerContact","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.contactId;return c("LSAddMessengerContact").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSInsertNewMediaSend",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.db.table(51).add({offlineAttachmentId:a[0],offlineThreadingId:a[1],inMessageIndex:a[2],attachmentType:a[3],shouldTranscode:a[4],useDoublePhase:a[5],sendByServer:a[6],isSecure:a[7],state:a[4]?b.i64.cast([0,1]):b.i64.cast([0,3])})},function(a){return b.resolve(c)}])}e.exports=a}),null);
__d("LSInsertNewMediaSendStoredProcedure",["LSInsertNewMediaSend","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.offlineAttachmentId;d[1]=b.offlineThreadingId;d[2]=b.inMessageIndex;d[3]=b.attachmentType;d[4]=b.shouldTranscode;d[5]=b.useDoublePhase;d[6]=b.sendByServer;d[7]=b.isSecure;return c("LSInsertNewMediaSend").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSLocalApplyOptimisticMessageWithAttachments",["LSArrayGetObjectAt","LSLocalApplyOptimisticMessage","LSSetMessageDisplayedContentTypes","gkx"],(function(a,b,c,d,e,f,g){function a(){var a=arguments,d=a[a.length-1],e=[],f=[];return d.sequence([function(g){return d.sequence([function(c){return d.storedProcedure(b("LSLocalApplyOptimisticMessage"),a[0],a[1],a[2],a[3],a[4],a[5],a[6],void 0,a[7],a[8],a[9],a[10],void 0,a[12],!0).then(function(a){return a=a,e[0]=a[0],e[1]=a[1],a})},function(f){return e[2]=d.i64.of_int32(a[11].length),d.i64.gt(e[2],d.i64.cast([0,0]))?d.loopAsync(e[2],function(f){return e[3]=f,d.sequence([function(c){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[11],e[3]).then(function(a){return a=a,e[4]=a[0],e[5]=a[1],a})},function(b){return e[6]=e[4].get("attachment_fbid"),e[4],e[7]=e[4].get("offline_attachment_id"),e[4],e[8]=e[4].get("attachment_type"),e[4],e[9]=e[4].get("filename"),e[4],e[10]=e[4].get("filesize"),e[4],e[11]=e[4].get("attachment_index"),e[4],e[12]=e[4].get("has_media"),e[4],e[13]=e[4].get("has_xma"),e[4],e[14]=e[4].get("playable_url"),e[4],e[15]=e[4].get("playable_url_mime_type"),e[4],e[16]=e[4].get("playable_duration_ms"),e[4],e[17]=e[4].get("preview_url"),e[4],e[18]=e[4].get("preview_url_mime_type"),e[4],e[19]=e[4].get("mini_preview"),e[4],e[20]=e[4].get("preview_width"),e[4],e[21]=e[4].get("preview_height"),e[4],e[22]=e[4].get("xma_layout_type"),e[4],e[23]=e[4].get("xmas_template_type"),e[4],e[24]=e[4].get("cta1_title"),e[4],e[25]=e[4].get("cta2_title"),e[4],e[26]=e[4].get("cta3_title"),e[4],e[27]=e[4].get("image_url"),e[4],e[28]=e[4].get("action_url"),e[4],e[29]=e[4].get("title_text"),e[4],e[30]=e[4].get("subtitle_text"),e[4],e[31]=e[4].get("description_text"),e[4],e[32]=e[4].get("source_text"),e[4],e[33]=e[4].get("original_file_hash"),e[4],e[34]=e[4].get("sound_bite_client_sound_key"),e[4],e[35]=e[4].get("sound_bite_visual"),e[4],e[36]=e[4].get("ephemeral_media_state"),e[4],e[37]=e[4].get("waveform_data"),e[4],e[38]=e[4].get("sampling_frequency_hz"),e[4],c("gkx")("4303")?(e[17]!==void 0?e[40]=e[17]:e[40]=e[14],e[39]=e[40]):e[39]=e[17],d.filter(d.db.table(16).fetch([[[a[1],e[0],e[6]]]]),function(b){return d.i64.eq(b.threadKey,a[1])&&d.i64.eq(d.i64.cast([0,0]),d.i64.cast([0,0]))&&b.messageId===e[0]&&b.attachmentFbid===e[6]&&d.i64.gt(b.authorityLevel,d.i64.cast([0,20]))}).next().then(function(b){var c=b.done;b.value;return c?d.db.table(16).put({threadKey:a[1],messageId:e[0],attachmentFbid:e[6],timestampMs:e[1],offlineAttachmentId:e[7],attachmentType:e[8],filename:e[9],filesize:e[10],attachmentIndex:e[11],hasMedia:e[12],hasXma:e[13],isSharable:!1,playableUrl:e[14],playableUrlMimeType:e[15],playableDurationMs:e[16],previewUrl:e[39],previewUrlMimeType:e[18],miniPreview:e[19],previewWidth:e[20],previewHeight:e[21],xmaLayoutType:e[22],xmasTemplateType:e[23],cta1Title:e[24],cta2Title:e[25],cta3Title:e[26],imageUrl:e[27],actionUrl:e[28],titleText:e[29],subtitleText:e[30],descriptionText:e[31],sourceText:e[32],ephemeralMediaState:e[36],originalFileHash:e[33],authorityLevel:d.i64.cast([0,20]),samplingFrequencyHz:e[38],waveformData:e[37]}):0})}])}):d.resolve()},function(c){return e[2]=d.i64.of_int32(a[11].length),d.i64.gt(e[2],d.i64.cast([0,0]))?d.storedProcedure(b("LSSetMessageDisplayedContentTypes"),a[1],e[0],e[1],a[3],!1,d.i64.neq(a[6],void 0)):d.resolve()},function(a){return a=[e[0],e[1]],f[0]=a[0],f[1]=a[1],a}])},function(a){return d.resolve(f)}])}d=a;g["default"]=d}),98);
__d("LSLocalApplyOptimisticMessageWithAttachmentsStoredProcedure",["LSLocalApplyOptimisticMessageWithAttachments","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.senderId;d[1]=b.threadKey;d[2]=b.threadType;d[3]=b.text;d[4]=b.snippet;d[5]=b.snippetHasEmoji;d[6]=b.stickerId;d[7]=b.replySourceId;d[8]=b.replySourceType;d[9]=b.replySourceTypeV2;d[10]=b.isForwarded;d[11]=b.attachments;d[12]=b.mentionData;return c("LSLocalApplyOptimisticMessageWithAttachments").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSMessageContentType",[],(function(a,b,c,d,e,f){a=Object.freeze({TEXT:1,MEDIA_PREVIEW:2,AUDIO_CLIP:4,XMA_FALLBACK:8,LWA_WAVE:16,ADMIN:32,FILE_ATTACHMENT:64,GLYPH:128,TOMBSTONE:256,STORY_REPLY:512,SINGLE_XMA:1024,HSCROLL_XMA:2048,STICKER:4096,FORWARD_INDICATOR:8192,ANIMATED_IMAGE:16384,NULL_STATE:32768,ENCRYPTION_PLACEHOLDER:65536,FUTUREPROOF_PLACEHOLDER:131072,UNAVAILABLE_PLACEHOLDER:262144,LOCATION_PLACEHOLDER:524288,POLL_CREATION_PLACEHOLDER:1048576,CONTACT_SHARE_PLACEHOLDER:2097152,STORY_MENTION_PLACEHOLDER:4194304,META_AI_MESSAGE_PLACEHOLDER:8388608,BUMP_MESSAGE_PLACEHOLDER:16777216,BUMP_MESSAGE_ORIGINAL_UNAVAILABLE_PLACEHOLDER:33554432,STICKER_RECEIVER_FETCH_UNSUPPORTED_PLACEHOLDER:67108864});f["default"]=a}),66);
__d("LSMessagePointQueryStoredProcedure",["LSMessagePointQuery","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadKey;d[1]=b.messageId;d[2]=b.threadType;d[3]=b.numContextMessages;return c("LSMessagePointQuery").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSOptimisticAcceptMessageRequest",["LSIssueNewTaskWithExtraOperations"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(e,f){f=e.done;e=e.value;return f?0:(e.item,c.sequence([function(b){return c.forEach(c.db.table(9).fetch([[[a[0]]]]),function(b){var d=b.update;b.item;return d({folderName:"inbox",parentThreadKey:c.i64.cast([0,0]),igFolder:a[1]})})},function(b){return c.db.table(173).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?0:(b=a.item,d[4]=b.clientThreadPk,c.db.table(276).fetch([[[d[4]]]]).next().then(function(a,b){b=a.done;a=a.value;return b?0:(a.item,c.forEach(c.db.table(276).fetch([[[d[4]]]]),function(a){var b=a.update;a.item;return b({folderType:c.i64.cast([0,0])})}))}))})},function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[0]=c.i64.cast([0,1]):(b=a.item,d[5]=b.syncGroup,c.i64.neq(d[5],void 0)?d[4]=d[5]:d[4]=c.i64.cast([0,1]),d[0]=d[4])})},function(e){return d[2]=new c.Map(),d[2].set("thread_key",a[0]),d[2].set("sync_group",d[0]),d[2].set("ig_folder",a[1]),d[3]=c.toJSON(d[2]),c.storedProcedure(b("LSIssueNewTaskWithExtraOperations"),"message_request",c.i64.cast([0,66]),d[3],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),void 0,c.i64.cast([0,0]))}]))})},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSOptimisticAcceptMessageRequestStoredProcedure",["LSOptimisticAcceptMessageRequest","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadKey;d[1]=b.igFolder;return c("LSOptimisticAcceptMessageRequest").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSOptimisticSendXMAMessageForwardFromSecureThread",["LSArrayGetObjectAt","LSIssueNewTaskWithExtraOperationsAndGetTaskID","LSLocalApplyOptimisticMessage","LSSetMessageDisplayedContentTypes","LSUpdateOptimisticAttachmentPreview"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return c.storedProcedure(b("LSLocalApplyOptimisticMessage"),a[0],a[1],a[2],a[3],void 0,void 0,void 0,void 0,void 0,void 0,c.i64.cast([0,3]),a[4],void 0,void 0,!0).then(function(a){return a=a,d[0]=a[0],d[1]=a[1],a})},function(e){return d[3]=c.i64.of_int32(a[6].length),c.i64.gt(d[3],c.i64.cast([0,0]))?c.loopAsync(d[3],function(e){return d[4]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[6],d[4]).then(function(a){return a=a,d[5]=a[0],d[6]=a[1],a})},function(e){return d[7]=d[5].get("attachment_fbid"),d[5],d[8]=d[5].get("offline_attachment_id"),d[5],d[9]=d[5].get("attachment_type"),d[5],d[10]=d[5].get("filename"),d[5],d[11]=d[5].get("filesize"),d[5],d[12]=d[5].get("attachment_index"),d[5],d[13]=d[5].get("has_media"),d[5],d[14]=d[5].get("has_xma"),d[5],d[15]=d[5].get("playable_url"),d[5],d[16]=d[5].get("playable_url_mime_type"),d[5],d[17]=d[5].get("playable_duration_ms"),d[5],d[18]=d[5].get("preview_url"),d[5],d[19]=d[5].get("preview_url_mime_type"),d[5],d[20]=d[5].get("mini_preview"),d[5],d[21]=d[5].get("preview_width"),d[5],d[22]=d[5].get("preview_height"),d[5],d[23]=d[5].get("xma_layout_type"),d[5],d[24]=d[5].get("xmas_template_type"),d[5],d[25]=d[5].get("cta1_title"),d[5],d[26]=d[5].get("cta2_title"),d[5],d[27]=d[5].get("cta3_title"),d[5],d[28]=d[5].get("image_url"),d[5],d[29]=d[5].get("action_url"),d[5],d[30]=d[5].get("title_text"),d[5],d[31]=d[5].get("subtitle_text"),d[5],d[32]=d[5].get("description_text"),d[5],d[33]=d[5].get("source_text"),d[5],d[34]=d[5].get("original_file_hash"),d[5],d[35]=d[5].get("sound_bite_client_sound_key"),d[5],d[36]=d[5].get("sound_bite_visual"),d[5],d[37]=d[5].get("ephemeral_media_state"),d[5],c.sequence([function(b){return c.forEach(c.filter(c.db.table(16).fetch([[[a[1],d[0],d[7]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&b.messageId===d[0]&&b.attachmentFbid===d[7]&&c.i64.lt(b.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(b){return c.db.table(16).add({threadKey:a[1],messageId:d[0],attachmentFbid:d[7],timestampMs:d[1],offlineAttachmentId:d[8],attachmentType:d[9],filename:d[10],filesize:d[11],attachmentIndex:d[12],hasMedia:d[13],hasXma:d[14],isSharable:!1,playableUrl:d[15],playableUrlMimeType:d[16],playableDurationMs:d[17],previewUrl:d[18],previewUrlMimeType:d[19],miniPreview:d[20],previewWidth:d[21],previewHeight:d[22],xmaLayoutType:d[23],xmasTemplateType:d[24],cta1Title:d[25],cta2Title:d[26],cta3Title:d[27],imageUrl:d[28],actionUrl:d[29],titleText:d[30],subtitleText:d[31],descriptionText:d[32],sourceText:d[33],ephemeralMediaState:d[37],originalFileHash:d[34],authorityLevel:c.i64.cast([0,20])})},function(e){return c.storedProcedure(b("LSSetMessageDisplayedContentTypes"),a[1],d[0],d[1],a[3],!1,!1)},function(e){return c.storedProcedure(b("LSUpdateOptimisticAttachmentPreview"),a[1],d[0],d[7],d[15],void 0,void 0,d[16],d[18],void 0,void 0,d[19],d[21],d[22])}])}])}):c.resolve()},function(e){return c.storedProcedure(b("LSIssueNewTaskWithExtraOperationsAndGetTaskID"),c.i64.to_string(a[1]),c.i64.cast([0,46]),"",void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),c.i64.cast([0,1]),void 0,c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[2]=a[0],a})},function(b){return c.db.table(31).add({taskId:d[2],threadKey:a[1],offlineThreadingId:d[0],threadAttributionSource:a[5],sendType:c.i64.cast([0,11]),markThreadRead:!1})},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSOptimisticSendXMAMessageForwardFromSecureThreadStoredProcedure",["LSOptimisticSendXMAMessageForwardFromSecureThread","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.senderId;d[1]=b.threadKey;d[2]=b.threadType;d[3]=b.text;d[4]=b.isForwarded;d[5]=b.source;d[6]=b.attachments;return c("LSOptimisticSendXMAMessageForwardFromSecureThread").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MAWFetchXMABlob",["FBLogger","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var d=a.descriptionForLogging,e=a.url,f=a.xmaContentType;return e==null||e===""?(h||(h=b("Promise"))).resolve():window.fetch(e).then(function(a){return a.blob()})["catch"](function(){c("FBLogger")("messenger_web_sharing").mustfix("Error fetching url in xma share from %s, with XMA content type %s",d,f);return(h||(h=b("Promise"))).resolve()})}g.fetchBlob=a}),98);
__d("MAWFetchXMAData_LinkPreviewQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="7846909995359316"}),null);
__d("MAWFetchXMAData_LinkPreviewQuery.graphql",["MAWFetchXMAData_LinkPreviewQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"url"}],c=[{alias:null,args:[{fields:[{kind:"Variable",name:"url",variableName:"url"}],kind:"ObjectValue",name:"params"}],kind:"ScalarField",name:"post_reshare_xma",storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"MAWFetchXMAData_LinkPreviewQuery",selections:c,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"MAWFetchXMAData_LinkPreviewQuery",selections:c},params:{id:b("MAWFetchXMAData_LinkPreviewQuery_facebookRelayOperation"),metadata:{},name:"MAWFetchXMAData_LinkPreviewQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("MAWUnshimUrl",["CometLinkShimUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(a==null)return void 0;var b=d("CometLinkShimUtils").getLinkShimInfo(a,void 0,void 0,void 0,void 0,!0);return!b.shimmed?a:b.unshimmedHref}g.unshimUrl=a}),98);
__d("MAWFetchXMAData",["fbt","CometRelay","ConstUriUtils","FBLogger","LSXmaContentType","MAWFetchXMABlob","MAWFetchXMAData_LinkPreviewQuery.graphql","MAWGetImageSpec","MAWParseXMAFBConfig","MAWUnshimUrl","MWQPLMarkers","Promise","WAArmadilloXMA.pb","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j;function k(a){var b=new Blob([],{type:"image/jpeg"});return{defaultCTA:{actionUrl:d("MAWUnshimUrl").unshimUrl(a),buttonType:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:d("MAWUnshimUrl").unshimUrl(a),title:h._("__JHASH__Xv8OyXI6-mU__JHASH__").toString()},linkType:"internal",overlayIconGlyph:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.PRIVATE,preview_blob:b,title_text:h._("__JHASH__2usVu04y012__JHASH__").toString()}}function l(a){var b=Object.entries(c("LSXmaContentType")).find(function(b){var c=b[0];b=b[1];return a===b&&d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE[c]!=null});b=b!=null?d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE[b[0]]:void 0;if(b===void 0)return void 0;if(!d("MAWParseXMAFBConfig").FB_SUPPORTED_TARGET_TYPES.has(b)){c("FBLogger")("messenger_web_sharing").mustfix("Unsupported XMA Target Type in sending path: "+b);return d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE}return b}function m(a,b,c,d){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){var h;try{h=JSON.parse(e)}catch(a){g(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FAILED_TO_PARSE_JSON_FOR_XMA_SHARE,{});throw c("FBLogger")("messenger_web_sharing").mustfixThrow("Failed to fetch blob xma data for MAWShareAttachent")}e=h;g=e.action_url;var i=e.ctas,k=e.default_cta_title,m=e.favicon_url,n=e.header_image_url,o=e.header_title,p=e.image_url,q=e.preview_url,r=e.subtitle_text,s=e.title_text;e=e.xma_content_type;var t=e;e=(yield (j||(j=b("Promise"))).all([m,p,q,n].map(function(a){return d("MAWFetchXMABlob").fetchBlob({descriptionForLogging:"MAWFetchXMAData",url:a,xmaContentType:t})}))["catch"](function(a){f(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FAILED_TO_FETCH_BLOB_FOR_XMA_SHARE);c("FBLogger")("messenger_web_sharing").mustfix("Failed to fetch blob xma data for MAWShareAttachent");return[void 0,void 0,void 0]}));m=e[0];p=e[1];q=e[2];n=e[3];e=i;i=l(t);var u=e==null?void 0:e[0];g=d("MAWUnshimUrl").unshimUrl((g=(g=g)!=null?g:u==null?void 0:u.action_url)!=null?g:a);a=d("MAWUnshimUrl").unshimUrl((u==null?void 0:u.native_url)!=null&&(u==null?void 0:u.native_url)!==""?u==null?void 0:u.native_url:g);g={actionUrl:g,buttonType:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:a,title:(u=k)!=null?u:void 0};f(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.RETURN_PUBLIC_XMA_DATA);a=c("gkx")("4186");return{ctas:e==null?void 0:e.map(function(a){return{actionUrl:d("MAWUnshimUrl").unshimUrl(a.action_url!=null&&a.action_url!==""?a.action_url:void 0),buttonType:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:d("MAWUnshimUrl").unshimUrl(a.native_url!=null&&a.native_url!==""?a.native_url:void 0),title:(a=a.title)!=null?a:void 0}}),defaultCTA:g,favicon_blob:(k=m)!=null?k:void 0,header_image_blob:a?(u=n)!=null?u:void 0:void 0,header_title:a?(e=o)!=null?e:void 0:void 0,image_blob:(g=p)!=null?g:void 0,linkType:"internal",preview_blob:(m=q)!=null?m:void 0,subtitle_text:(k=r)!=null?k:void 0,title_text:(n=s)!=null?n:void 0,xma_message_type:i}});return n.apply(this,arguments)}function o(a,c){return d("CometRelay").fetchQuery(a,i!==void 0?i:i=b("MAWFetchXMAData_LinkPreviewQuery.graphql"),{url:c}).toPromise()}function a(a,b,c,d){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f){e(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.XMA_DATA_FETCH_BEGIN);b=d("ConstUriUtils").getUri(b);b=b==null?void 0:(b=b.setSubDomain("www"))==null?void 0:b.toString();if(b==null)return{linkType:"unknown"};e(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.XMA_DATA_QUERY_BEGIN);a=(yield o(a,b)["catch"](function(a){f(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FAILED_TO_FETCH_QUERY_DATA_FOR_XMA_SHARE,{}),c("FBLogger")("messenger_web_sharing").mustfix("Failed execute MAWShareAttachment_LinkPreviewQuery for MAWShareAttachent")}));e(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.XMA_DATA_QUERY_COMPLETE);if(a==null){e(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.MISSING_XMA_DATA);return{linkType:"unknown"}}a=a.post_reshare_xma;if(a==null){e(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.MISSING_XMA_DATA);return{linkType:"external"}}if(a==="private"){e(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.RETURN_PRIVATE_XMA_DATA);return k(b)}return m(b,a,e,f)});return p.apply(this,arguments)}function e(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=a.favicon_blob,f=a.header_image_blob,g=a.overlayIconGlyph;a=a.preview_blob;a=a==null?void 0:new File([a],"preview",{type:a.type});e=e==null?void 0:new File([e],"favicon",{type:e.type});f=f==null?void 0:new File([f],"header",{type:f.type});g=g===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.PRIVATE?(j||(j=b("Promise"))).resolve({height:2,width:2}):a!=null?d("MAWGetImageSpec").getImageSpec_DEPRECATED(a):(j||(j=b("Promise"))).resolve();var h=e!=null?d("MAWGetImageSpec").getImageSpec_DEPRECATED(e):(j||(j=b("Promise"))).resolve(),i=f!=null?d("MAWGetImageSpec").getImageSpec_DEPRECATED(f):(j||(j=b("Promise"))).resolve();g=(yield (j||(j=b("Promise"))).all([g,h,i]));h=g[0];i=g[1];g=g[2];c(d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.PREVIEW_FAVICON_SPEC_READY);c=a==null||h==null?void 0:{file:a,height:h.height,width:h.width};a=e==null||i==null?void 0:{file:e,height:i.height,width:i.width};h=f==null||g==null?void 0:{file:f,height:g.height,width:g.width};return{faviconFileArgs:a,headerImageFileArgs:h,previewFileArgs:c}});return q.apply(this,arguments)}g.fetchXMAData=a;g.makeXMAFileArgs=e}),226);
__d("MAWSendFileMsgTypes",["WAStanzaUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a}function b(a){return d("WAStanzaUtils").toStanzaId(a)}g.toOfflineAttachmentIDFromStanzaId=a;g.toOfflineAttachmentIDFromString=b}),98);
__d("MAWSecureAttachmentGroupingUtils",["I64","LSIntEnum","MAWSendFileMsgTypes","MessagingAttachmentType","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){a=a.reduce(function(a,b){(h||(h=d("I64"))).equal(b.attachmentType,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))?a.mediaStagingsImage.push(b):a.mediaStagingsOther.push(b);return a},{mediaStagingsImage:[],mediaStagingsOther:[]});var b=a.mediaStagingsImage;a=a.mediaStagingsOther;return[].concat(b,a)}function b(a){var b=new Map();a=a.filter(function(a){return(h||(h=d("I64"))).equal(a.attachmentType,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))});var e=a.length;if(e>1){var f=c("uuidv4")();a.forEach(function(a,c){b.set(d("MAWSendFileMsgTypes").toOfflineAttachmentIDFromString(a.offlineAttachmentId),{groupId:f,groupIndex:c,groupSize:e})})}return b}function e(a){var b=new Map(),d=a.length;if(d>1){var e=c("uuidv4")();a.forEach(function(a,c){b.set(a,{groupId:e,groupIndex:c,groupSize:d})})}return b}g.orderMediaStagingsForGrouping=a;g.generateMediaGroupMetadataForMediaStagings=b;g.generateMediaGroupMetadataForMessageIds=e}),98);
__d("MAWForwardMessage",["MAWBridgeSendAndReceive","MAWCreateOneToOneThread","MAWGetEphemeralSettings","MAWJobDefinitions","MAWMiActOnActThreadReady","MAWSecureAttachmentGroupingUtils","MAWThreadId","MAWTimedJob","Promise","WAJobOrchestratorTypes","asyncToGeneratorRuntime","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=(yield d("MAWThreadId").isSecureThreadId(a.tables,b)),f=!1;e||(yield d("MAWCreateOneToOneThread").call(a,b,void 0,"maybeCreateNewThreadAndCallback"),f=!0);return d("MAWMiActOnActThreadReady").onActThreadReady(a.tables,b,"MAWForwardMessage",function(a,b){return c(b,f)})});return j.apply(this,arguments)}function a(a,b,d,e,f){c("promiseDone")(l(a,b,d,e,f))}function e(a,b,c,d,e){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g){var i=d("MAWSecureAttachmentGroupingUtils").generateMediaGroupMetadataForMessageIds(e);yield (h||(h=b("Promise"))).allSettled([e.map(function(b){return l(a,c,b,f,g,i.get(b))})])});return k.apply(this,arguments)}function l(a,b,c,e,f,g){return i(a,b,function(a,h){return d("MAWBridgeSendAndReceive").sendAndReceive("backend","getProtocolMsgIdByMsgId",{msgId:c}).then(function(c){if(c!=null)return d("MAWGetEphemeralSettings").getEphemeralSetting(a,b).then(function(b){return d("MAWTimedJob").TimedUIJobStarters.waitUntilPersisted(d("MAWJobDefinitions").jobSerializers.forwardMsg(a,c,(b=b)!=null?b:void 0,void 0,h,{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},{mediaGroupMetadata:g,s2sInstanceKey:f,source:e}))})})})}g.maybeCreateNewThreadAndCallback=i;g.forwardMessage=a;g.forwardMessageBatch=e}),98);
__d("OfflineThreadingId",["I64","XPlatReactCrypto"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("I64"))).of_string("4194303");function a(){return(h||(h=d("I64"))).to_string(j())}function j(){var a=d("XPlatReactCrypto").getRandomValues(new Uint8Array(8));a=new DataView(a.buffer);a=(h||(h=d("I64"))).add(h.lsl_(h.of_int32(a.getUint32(0)),32),h.of_int32(a.getUint32(4)));return k(Date.now(),a)}function k(a,b){return(h||(h=d("I64"))).and_(h.or_(h.lsl_(h.of_float(a),22),h.and_(b,i)),h.max_int)}function b(a){var b=j(),c=[];for(var e=0;e<a.length;e++)c.push([a[e],(h||(h=d("I64"))).to_string(b)]),b=l(b);return c}function l(a,b){b===void 0&&(b=(h||(h=d("I64"))).one);var c=m(a);a=n(a);return k(c,(h||(h=d("I64"))).add(a,b))}function m(a){return(h||(h=d("I64"))).to_float(h.lsr_(a,22))}function n(a){return(h||(h=d("I64"))).and_(a,i)}g.createOfflineThreadingID=a;g.createForItemsInOrder=b;g.extractTimestamp=m}),98);
__d("MAWForwardMessageFromSecureThread.react",["I64","LSFactory","LSHotEmojiSize","LSInsertNewMediaSendStoredProcedure","LSIntEnum","LSLocalApplyOptimisticMessageWithAttachmentsStoredProcedure","LSMailboxType","LSMarkSubJobCompletedV2StoredProcedure","LSOptimisticSendMessageV2StoredProcedure","LSOptimisticSendXMAMessageForwardFromSecureThreadStoredProcedure","LSShape","LSVec","MAWBridgeSendAndReceive","MAWDbMedia","MAWDbXMA","MWPComposerMediaUploadUtil","MWPOpenComposerUtils","MessagePowerUp","MessagingAttachmentType","OfflineThreadingId","Promise","ReQL","WAHashUtils","asyncToGeneratorRuntime","cr:2472","gkx","promiseDone","recoverableViolation","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,b,c){return{action_url:void 0,attachment_fbid:b,attachment_index:(j||(j=d("I64"))).zero,attachment_type:a.attachmentType,cta1_title:void 0,cta2_title:void 0,cta3_title:void 0,description_text:void 0,filename:a.filename,filesize:void 0,has_media:!0,has_xma:!1,image_url:void 0,mini_preview:void 0,offline_attachment_id:b,original_file_hash:void 0,playable_duration_ms:a.playableDurationMs,playable_url:URL.createObjectURL(c),playable_url_mime_type:c.type,preview_height:void 0,preview_url:void 0,preview_url_mime_type:void 0,preview_width:void 0,source_text:void 0,subtitle_text:void 0,title_text:void 0,xma_layout_type:void 0,xmas_template_type:void 0}}function l(a,b,c,e){var f;return{action_url:(f=b==null?void 0:b.actionUrl)!=null?f:b==null?void 0:b.nativeUrl,attachment_fbid:c,attachment_index:(j||(j=d("I64"))).zero,attachment_type:a.attachmentType,cta1_title:a.cta1Title,cta2_title:a.cta2Title,cta3_title:a.cta3Title,description_text:a.descriptionText,filename:a.filename,filesize:a.filesize,has_media:!1,has_xma:!0,image_url:void 0,mini_preview:void 0,offline_attachment_id:c,original_file_hash:void 0,playable_duration_ms:void 0,playable_url:e!=null?URL.createObjectURL(e):void 0,playable_url_mime_type:e==null?void 0:e.type,preview_height:void 0,preview_url:e!=null?URL.createObjectURL(e):void 0,preview_url_mime_type:e==null?void 0:e.type,preview_width:void 0,source_text:a.sourceText,subtitle_text:a.subtitleText,title_text:a.titleText,xma_layout_type:a.xmaLayoutType,xmas_template_type:a.xmasTemplateType}}function m(a,e,f,g,i,j,k,l){l=c("LSFactory")(l);return c("LSOptimisticSendXMAMessageForwardFromSecureThreadStoredProcedure")(l,{attachments:c("LSVec").ofArray([d("LSShape").ofRecord(j)]),isForwarded:i,senderId:a,source:k,text:(l=g)!=null?l:void 0,threadKey:e,threadType:f}).then(function(){return(h||(h=b("Promise"))).resolve()})}function n(a,b){return a==null||b==null?void 0:{amplitudes:b.split(",").map(parseFloat),sampling_freq:a}}function o(a,e,g,k,l,m,o,p,q){var r=c("LSFactory")(p);return c("LSLocalApplyOptimisticMessageWithAttachmentsStoredProcedure")(r,{attachments:c("LSVec").ofArray([d("LSShape").ofRecord(e)]),isForwarded:m,senderId:o,threadKey:l,threadType:k}).then(function(a){var c=a[0];a[1];return p.messages_optimistic_context.add({externalAttachmentUrl:void 0,initiatingSource:void 0,markThreadRead:!1,messageId:void 0,offlineThreadingId:c,platformRef:void 0,platformToken:void 0,replySourceId:void 0,replySourceType:void 0,sendType:void 0,skipUrlPreviewGen:void 0,taskId:(j||(j=d("I64"))).of_string(c),threadAttributionSource:q,threadKey:l}).then(function(){return(h||(h=b("Promise"))).resolve(c)})}).then(function(a){var f=e.attachment_fbid;return c("LSInsertNewMediaSendStoredProcedure")(r,{attachmentType:e.attachment_type,inMessageIndex:(j||(j=d("I64"))).zero,isSecure:!1,offlineAttachmentId:f,offlineThreadingId:a,sendByServer:!1,shouldTranscode:!1,useDoublePhase:!1}).then(function(){return(h||(h=b("Promise"))).resolve([a,f])})}).then(function(b){var h=b[0],k=b[1];b=function(b,e){if(e==null||e.length===0)return;c("promiseDone")(a.runInTransaction(function(a){var b=c("LSFactory")(a);return c("LSMarkSubJobCompletedV2StoredProcedure")(b,{fbid:(j||(j=d("I64"))).of_string(e),offlineAttachmentId:k}).then(function(){return d("MWPOpenComposerUtils").resumeSendJob(b,h)})},"readwrite",void 0,void 0,f.id+":222"))};return d("MWPComposerMediaUploadUtil").startUpload(void 0,void 0,b,void 0,(j||(j=d("I64"))).equal(e.attachment_type,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO)),[g],[k],void 0,void 0,n(e.sampling_frequency_hz,e.waveform_data),void 0,void 0)})}function a(a,b,c,d,e,f,g,h){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,g,p,q,r,s,t){if(r!=null){var u=r.attachmentType;if(!((j||(j=d("I64"))).equal(u,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO))||(j||(j=d("I64"))).equal(u,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(j||(j=d("I64"))).equal(u,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))||(j||(j=d("I64"))).equal(u,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))||(j||(j=d("I64"))).equal(u,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE))||(j||(j=d("I64"))).equal(u,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA))))throw c("unrecoverableViolation")("We do not support forwarding this type","messenger_web_sharing");var v=null;if(!(j||(j=d("I64"))).equal(u,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA))){!c("gkx")("2419")||isFinite(r.attachmentFbid)?v=(yield d("MAWBridgeSendAndReceive").sendAndReceive("backend","getBlobDataUrlByMediaId",{description:"MAWForwardMessageFromSecureThread",mediaId:d("MAWDbMedia").convertNumberToMediaId(Number.parseInt(r.attachmentFbid,10))})):v=(yield d("MAWBridgeSendAndReceive").sendAndReceive("backend","getBlobDataUrlByHashedPlaintextHash",{description:"MAWForwardMessageFromSecureThread",plaintextHash:d("WAHashUtils").stringToPlaintextHash(r.attachmentFbid)}));if(v==null)return}yield a.runInTransaction(function(f){switch(!0){case(j||(j=d("I64"))).equal(u,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO)):if(v==null)throw c("unrecoverableViolation")("Blob can not be null for MessagingAttachmentType.AUDIO","messenger_web_sharing");var w=new File([v],"mediaForwardedFromSecureThread",{type:v.type}),x=d("OfflineThreadingId").createOfflineThreadingID();x=d("MWPComposerMediaUploadUtil").getAudioAttachment(x,w,(j||(j=d("I64"))).to_int32((x=r.playableDurationMs)!=null?x:(j||(j=d("I64"))).zero)/1e3,n(r.samplingFrequencyHz!=null?(j||(j=d("I64"))).to_int32(r.samplingFrequencyHz):void 0,r.waveformData));return o(a,x,w,g,e,q,s,f,t);case(j||(j=d("I64"))).equal(u,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA)):return d("ReQL").firstAsync(d("ReQL").fromTableDescending(f.attachment_ctas).getKeyRange((x=r.defaultCtaId)!=null?x:(j||(j=d("I64"))).zero)).then(function(a){return d("MAWBridgeSendAndReceive").sendAndReceive("backend","getBlobDataUrlByXMAId",{description:"MAWForwardMessageFromSecureThread",infoType:"preview",xmaId:d("MAWDbXMA").convertNumberToXMAId(Number.parseInt(r.attachmentFbid,10))}).then(function(c){return(h||(h=b("Promise"))).resolve([a,c])})["catch"](function(d){c("recoverableViolation")("Unable to getBlobDataUrlByXMAId, from MAWForwardMessageFromSecureThread","messenger_web_media",{error:d},{trackOnly:!0});return(h||(h=b("Promise"))).resolve([a,void 0])})}).then(function(a){var c=a[0];a=a[1];var h=null;a!=null&&(h=new File([a],"xmaForwardedFromSecureThread",{type:a.type}));a=d("OfflineThreadingId").createOfflineThreadingID();c=l(r,c,a,h);a=p.text;h=b("cr:2472")==null||a==null?a:b("cr:2472").unvault(a);return m(s,e,g,h,q,c,t,f)});case(j||(j=d("I64"))).equal(u,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE)):case(j||(j=d("I64"))).equal(u,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE)):case(j||(j=d("I64"))).equal(u,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)):case(j||(j=d("I64"))).equal(u,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE)):if(v==null)throw c("unrecoverableViolation")("Blob can not be null for MessagingAttachmentType.AUDIO","messenger_web_sharing");x=new File([v],(w=r.filename)!=null?w:"mediaForwardedFromSecureThread",{type:v.type});w=d("OfflineThreadingId").createOfflineThreadingID();w=k(r,w,x);return o(a,w,x,g,e,q,s,f,t);default:throw c("unrecoverableViolation")("We do not support forwarding this type","messenger_web_sharing")}},"readwrite",void 0,void 0,f.id+":332")}else{var w=p.text;if(w==null)throw c("unrecoverableViolation")("We do not support forwarding this type","messenger_web_sharing");var x=b("cr:2472")==null?w:b("cr:2472").unvault(w),y=x==="\ud83d\udc4d"&&p.hotEmojiSize!=null&&(j||(j=d("I64"))).equal(p.hotEmojiSize,(i||(i=d("LSIntEnum"))).ofNumber(c("LSHotEmojiSize").SMALL)),z=y?(j||(j=d("I64"))).of_string("369239263222822"):void 0;yield a.runInTransaction(function(a){return c("LSOptimisticSendMessageV2StoredProcedure")(c("LSFactory")(a),{extraSendMessageParams:d("LSShape").ofRecord({calculate_denormalizations:!1,is_forwarded:q,mark_read:!1,power_up_style:(i||(i=d("LSIntEnum"))).ofNumber(c("MessagePowerUp").NONE),source:t,sticker_id:z}),mailboxType:i.ofNumber(c("LSMailboxType").MESSENGER),senderId:s,text:y?void 0:x,threadKey:e,threadType:g})},"readwrite",void 0,void 0,f.id+":511")}});return p.apply(this,arguments)}g.getMediaAttachment=k;g.uploadAndSendMediaToOpenThread=o;g.forwardMessage=a}),98);
__d("MAWShareAttachmentQPLFunctions",["QPLUserFlow","qpl"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=function(b){c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),b,{instanceKey:a})},d=function(b){c("QPLUserFlow").addAnnotations(c("qpl")._(25313175,"1551"),b,{instanceKey:a})},e=function(b,d){d===void 0&&(d={}),c("QPLUserFlow").endFailure(c("qpl")._(25313175,"1551"),b,{annotations:d,instanceKey:a})};return{addQplAnnotations:d,addQplPoint:b,failS2S:e}}g.getQPLFunctions=a}),98);
__d("MAWFowardMessageFromOpenThread",["I64","LSIntEnum","MAWDocumentPreProcess","MAWExternalId","MAWFetchXMABlob","MAWFetchXMAData","MAWForwardMessage","MAWGetEphemeralSettings","MAWGetImageSpec","MAWImagePreProcess","MAWJobDefinitions","MAWShareAttachmentQPLFunctions","MAWUIJob","MAWUnshimUrl","MAWVideoUtils","MessagingAttachmentType","Promise","ReQL","WAArmadilloXMA.pb","WAJobOrchestratorTypes","asyncToGeneratorRuntime","gkx","promiseDone","qpl","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,c){return(j||(j=b("Promise"))).all([d("MAWGetImageSpec").getImageSpec_DEPRECATED(a),j.resolve(a),c.arrayBuffer(),d("MAWGetImageSpec").getImageSpec_DEPRECATED(c)]).then(function(a){var c=a[0],d=a[1],e=a[2];a=a[3];return(j||(j=b("Promise"))).resolve({file:d,imageSpec:c,thumbnailUrlAndSpec:{duration:void 0,height:a.height,jpegThumbnail:e,width:a.width},type:"image"})})}function l(a){return d("MAWVideoUtils").getVideoThumbnailUrlAndSpec(a).then(function(c){return(j||(j=b("Promise"))).resolve({file:a,thumbnailUrlAndSpec:c,type:"video"})})}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("MAWFetchXMABlob").fetchBlob({descriptionForLogging:"MAWFowardMessageFromOpenThread",url:a}));b=a==null?void 0:new File([a],b,{type:a.type});a=b!=null?yield d("MAWGetImageSpec").getImageSpec_DEPRECATED(b):null;return b!=null&&a!=null?{file:b,height:a.height,width:a.width}:void 0});return n.apply(this,arguments)}function o(a,b,c){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(c.tables.attachment_ctas).getKeyRange(a)));return c==null||b==null&&c.actionUrl==null?null:{actionUrl:(a=c==null?void 0:c.actionUrl)!=null?a:void 0,buttonType:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:(a=c==null?void 0:c.actionUrl)!=null?a:void 0,title:(c=b)!=null?c:void 0}});return p.apply(this,arguments)}function q(a,b,c,d){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f){f=d("MAWShareAttachmentQPLFunctions").getQPLFunctions(f);var g=f.addQplPoint;f=f.failS2S;var h=(yield s(b,e));if((h==null?void 0:h.actionUrl)==null)throw c("unrecoverableViolation")("Cannot forward XMA to secure threads without a defaultCTA and actionUrl","messenger_web_sharing");a=(yield d("MAWFetchXMAData").fetchXMAData(a,h.actionUrl,g,f));if(a.linkType==="unknown")throw c("unrecoverableViolation")("Cannot forward XMA to secure threads with an unknown link type","messenger_web_sharing");if(a.linkType==="external")return w(b,h,e,a);else return u(a,g)});return r.apply(this,arguments)}function s(a,b){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a.actionUrl,e=a.defaultCtaId;a=a.defaultCtaTitle;if(e==null)return null;e=(yield o(e,a,b));return(b=e)!=null?b:{actionUrl:(e=c)!=null?e:void 0,buttonType:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:(b=c)!=null?b:void 0,title:(e=a)!=null?e:void 0}});return t.apply(this,arguments)}function u(a,b){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("MAWFetchXMAData").makeXMAFileArgs(a,b));var c=a.ctas,e=a.defaultCTA,f=a.overlayIconGlyph,g=a.subtitle_text,h=a.title_text;a=a.xma_message_type;c={ctas:c,defaultCTA:e,overlayIconGlyph:f,subtitleText:g,titleText:h};return babelHelpers["extends"]({},b,{xmaArgs:c,xmaMessageType:(e=a)!=null?e:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE})});return v.apply(this,arguments)}function w(a,b,c,d){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){var g=a.attachmentCta1Id,i=a.attachmentCta2Id,k=a.attachmentCta3Id,l=a.cta1Title,n=a.cta2Title,p=a.cta3Title,q=a.faviconUrl,r=a.headerImageUrl,s=a.headerTitle,t=a.maxSubtitleNumOfLines,u=a.maxTitleNumOfLines,v=a.previewUrl,w=a.subtitleText;a=a.titleText;q=(yield (j||(j=b("Promise"))).all([[q,"favicon"],[r,"headerImage"],[v,"preview"]].map(function(a){return m(a[0],a[1])})));r=q[0];v=q[1];q=q[2];var x=[];if(g!=null){g=(yield o(g,l,e));g!=null&&x.push(g)}if(i!=null){l=(yield o(i,n,e));l!=null&&x.push(l)}if(k!=null){g=(yield o(k,p,e));g!=null&&x.push(g)}l={ctas:x.map(function(a){return babelHelpers["extends"]({},a,{actionUrl:d("MAWUnshimUrl").unshimUrl(a.actionUrl),nativeUrl:d("MAWUnshimUrl").unshimUrl(a.nativeUrl)})}),defaultCTA:babelHelpers["extends"]({},c,{actionUrl:d("MAWUnshimUrl").unshimUrl(c.actionUrl),nativeUrl:d("MAWUnshimUrl").unshimUrl(c.nativeUrl)}),headerTitle:s,maxSubtitleNumOfLines:(h||(h=d("I64"))).to_int32((i=t)!=null?i:(h||(h=d("I64"))).zero),maxTitleNumOfLines:h.to_int32((n=u)!=null?n:(h||(h=d("I64"))).zero),overlayIconGlyph:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.NONE,subtitleText:w,titleText:a};return{faviconFileArgs:r,headerFileArgs:v,previewFileArgs:q,xmaArgs:l,xmaMessageType:f.xma_message_type}});return x.apply(this,arguments)}function y(a){var e=a.attachmentType,f=a.filename,g=a.playableDurationMs,m=a.playableUrl,n=a.playableUrlMimeType,o=a.previewUrl,p=a.previewUrlMimeType;if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))||(h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))||(h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE))){if(m==null)throw c("unrecoverableViolation")("If you see this error, there is no playableUrl for this attachment","messenger_web_sharing");var q=(h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE));if(o!=null){a=q?o+"&":m;var r=q?o+"&":o;return(j||(j=b("Promise"))).all([window.fetch(a).then(function(a){return a.blob()}),window.fetch(r).then(function(a){return a.blob()})]).then(function(a){var b=a[0];a=a[1];b=new File([b],"mediaForwardedFromOpenThread",{type:q?p:n});a=new File([a],"previewForwardedFromOpenThread",{type:p});if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE)))return k(b,a);if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)))return l(b);if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE)))return k(b,a);throw c("unrecoverableViolation")("shouldn't have this error in forward message from open thread","messenger_web_sharing")})}a=q?m+"&":m;return window.fetch(a).then(function(a){return a.blob()}).then(function(a){if(q&&n==="video/mp4")throw c("unrecoverableViolation")("If you see this error, there is only mp4 url for gif","messenger_web_sharing");a=new File([a],(a=f)!=null?a:"mediaForwardedFromOpenThread",{type:n});if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE)))return d("MAWImagePreProcess").imagePreprocess(a,!1);if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)))return l(a);if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE)))return d("MAWDocumentPreProcess").documentPreprocess(a);if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE)))return(j||(j=b("Promise"))).all([d("MAWImagePreProcess").getJpegThumbnailInfo(a,400),d("MAWGetImageSpec").getImageSpec_DEPRECATED(a),j.resolve(a)]).then(function(a){var c=a[0],d=a[1];a=a[2];return(j||(j=b("Promise"))).resolve({file:a,imageSpec:d,thumbnailUrlAndSpec:c,type:"image"})});throw c("unrecoverableViolation")("shouldn't have this error in forward message from open thread","messenger_web_sharing")})}if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO))){if(m!=null)return window.fetch(m+"&").then(function(a){return a.blob()}).then(function(a){var c;a=new File([a],"mediaForwardedFromOpenThread",{type:n});return(j||(j=b("Promise"))).resolve({durations:(h||(h=d("I64"))).to_int32((c=g)!=null?c:(h||(h=d("I64"))).zero)/1e3,file:a,isPtt:!0,type:"audio"})});throw c("unrecoverableViolation")("If you see this error, there is no playableUrl for this audio attachment","messenger_web_sharing")}if((h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").STICKER))){if(m==null&&o==null)throw c("unrecoverableViolation")("If you see this error, there is no url for this sticker","messenger_web_sharing");return m!=null?o!=null?(j||(j=b("Promise"))).all([window.fetch(m).then(function(a){return a.blob()}),window.fetch(o).then(function(a){return a.blob()})]).then(function(a){var b=a[0];a=a[1];b=new File([b],"mediaForwardedFromOpenThread",{type:n});a=new File([a],"previewForwardedFromOpenThread",{type:p});return k(b,a)}):window.fetch(m).then(function(a){return a.blob()}).then(function(a){a=new File([a],"mediaForwardedFromOpenThread",{type:n});return k(a,a)}):window.fetch(o).then(function(a){return a.blob()}).then(function(a){return d("MAWImagePreProcess").imagePreprocess(new File([a],"previewForwardedFromOpenThread",{type:p}),!0)})}throw c("unrecoverableViolation")("We do not support forwarding other media types","messenger_web_sharing")}function a(a,e,f,g,k,l,m,n){c("promiseDone")(d("MAWForwardMessage").maybeCreateNewThreadAndCallback(e,f,function(o,p){var r=d("MAWGetEphemeralSettings").getEphemeralSetting(o,f),s=p;return r.then(function(f){if(l!=null){if(l.attachmentFbid==="369239263222822"||l.attachmentFbid==="369239343222814"||l.attachmentFbid==="369239383222810"){var p;return d("MAWUIJob").UIJobStarters.waitUntilPersisted(d("MAWJobDefinitions").createStartJobInfo("sendMsg",{args:{content:"\ud83d\udc4d",ephemeralSetting:(p=f)!=null?p:void 0,isFirstMsg:s,isForwarded:k,s2sInstanceKey:n,source:m,specialTextSize:1},chatJid:o,externalId:d("MAWExternalId").generateExternalId(),scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}}))}return(h||(h=d("I64"))).equal(l.attachmentType,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA))?q(a,l,e,n).then(function(a){var b,e=a.faviconFileArgs,h=a.headerFileArgs,i=a.previewFileArgs,j=a.xmaArgs;a=a.xmaMessageType;return d("MAWUIJob").UIJobStarters.waitUntilCompleted(d("MAWJobDefinitions").createStartJobInfo("sendXMAShareMsg",{args:{content:c("gkx")("3194")?g.text:void 0,ephemeralSetting:(b=f)!=null?b:void 0,isFirstMsg:s,isForwarded:!0,s2sInstanceKey:n,s2sUserFlowQPLEvent:c("qpl")._(25313175,"1551"),xmaMessageType:(b=a)!=null?b:d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE},chatJid:o,faviconFile:e,headerFile:h,previewFile:i,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},xmaArgs:j,xmaMsgExternalId:d("MAWExternalId").generateExternalId()}))}):y(l).then(function(a){switch(a.type){case"image":var c,e=a.imageSpec,g=a.thumbnailUrlAndSpec;d("MAWUIJob").UIJobStarters.fireAndForget(d("MAWJobDefinitions").createStartJobInfo("sendMediaMsg",{args:{ephemeralSetting:(c=f)!=null?c:void 0,height:e.height,isFirstMsg:s,isForwarded:k,jpegThumbnail:g.jpegThumbnail,jpegThumbnailHeight:g.height,jpegThumbnailWidth:g.width,s2sInstanceKey:n,source:m,width:e.width},chatJid:o,externalId:d("MAWExternalId").generateExternalId(),file:a.file,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}}));break;case"video":c=a.thumbnailUrlAndSpec;d("MAWUIJob").UIJobStarters.fireAndForget(d("MAWJobDefinitions").createStartJobInfo("sendMediaMsg",{args:{duration:c.duration,ephemeralSetting:(g=f)!=null?g:void 0,height:c.height,isFirstMsg:s,isForwarded:k,jpegThumbnail:c.jpegThumbnail,jpegThumbnailHeight:c.height,jpegThumbnailWidth:c.width,s2sInstanceKey:n,source:m,width:c.width},chatJid:o,externalId:d("MAWExternalId").generateExternalId(),file:a.file,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}}));break;case"audio":e=a.durations;g=a.isPtt;d("MAWUIJob").UIJobStarters.fireAndForget(d("MAWJobDefinitions").createStartJobInfo("sendMediaMsg",{args:{duration:Math.round(e),ephemeralSetting:(c=f)!=null?c:void 0,isFirstMsg:s,isForwarded:k,isPtt:g,s2sInstanceKey:n,source:m},chatJid:o,externalId:d("MAWExternalId").generateExternalId(),file:a.file,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}}));break;case"document":d("MAWUIJob").UIJobStarters.fireAndForget(d("MAWJobDefinitions").createStartJobInfo("sendMediaMsg",{args:{ephemeralSetting:(e=f)!=null?e:void 0,filename:a.filename,isFirstMsg:s,isForwarded:k,s2sInstanceKey:n,source:m},chatJid:o,externalId:d("MAWExternalId").generateExternalId(),file:a.file,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}}));break}return(j||(j=b("Promise"))).resolve()})}p=g.text;if(p!=null){return d("MAWUIJob").UIJobStarters.fireAndForget(d("MAWJobDefinitions").createStartJobInfo("sendMsg",{args:{content:g.text,ephemeralSetting:(p=f)!=null?p:void 0,isFirstMsg:s,isForwarded:k,s2sInstanceKey:n,source:m},chatJid:o,externalId:d("MAWExternalId").generateExternalId(),scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}}))}throw c("unrecoverableViolation")("We do not support forwarding this types","messenger_web_sharing")})}))}g.downloadMediaByUrl=y;g.forwardMessage=a}),98);
__d("MWChatMediaViewerNavigationTapTarget.react",["ix","CometTrackingNodeProvider.react","FDSSkittleIcon.react","MWXPressable.react","fbicon","react","stylex"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||d("react"),l={buttonContainerBackground:{backgroundColor:"xiwuv7k",$$css:!0},buttonContainerHoverLeft:{opacity:"x1hc1fzr",transform:"xs51lif",$$css:!0},buttonContainerHoverRight:{opacity:"x1hc1fzr",transform:"xzycz3q",$$css:!0},fullHeight:{height:"x5yr21d",$$css:!0},invisible:{opacity:"xg01cxk",transitionDuration:"xhb22t3",transitionTimingFunction:"xls3em1",visibility:"xlshs6z",$$css:!0},navButton:{alignItems:"x6s0dn4",display:"x78zum5",opacity:"x197sbye",paddingTop:"xyamay9",paddingEnd:"x1pi30zi",paddingBottom:"x1l90r2v",paddingStart:"x1swvt13",position:"x1n2onr6",transitionDuration:"x1k90msu",transitionProperty:"x6o7n8i",transitionTimingFunction:"x9lcvmn",willChange:"x6my1t9",$$css:!0},root:{alignItems:"x6s0dn4",display:"x78zum5",justifyContent:"xl56j7k",opacity:"x1hc1fzr",position:"x1n2onr6",transitionDuration:"x1ebt8du",transitionProperty:"x1jl3cmp",transitionTimingFunction:"x1dhq9h",willChange:"xfwg19i",zIndex:"x1vjfegm",$$css:!0},tapTargetOverlay:{height:"x5yr21d",$$css:!0}};function a(a){var b=a.direction,e=a.disable,f=e===void 0?!1:e;e=a.invisible;e=e===void 0?!1:e;var g=a.label,j=a.onClick,m=a.testid;m=a.trackingNode;a=k.jsx(c("MWXPressable.react"),{"aria-label":g,focusable:!1,onPress:j,testid:void 0,xstyle:l.tapTargetOverlay,children:function(a){a=a.hovered;return k.jsx("div",{className:(i||(i=c("stylex")))(l.navButton,l.buttonContainerBackground,a&&(b==="previous"?l.buttonContainerHoverLeft:l.buttonContainerHoverRight)),children:k.jsx(c("FDSSkittleIcon.react"),{color:"gray",disabled:f,icon:b==="previous"?d("fbicon")._(h("492491"),24):d("fbicon")._(h("492539"),24),size:48})})}});return k.jsx("div",{className:(i||(i=c("stylex")))(l.root,e&&l.invisible,l.fullHeight),children:m!=null?k.jsx(c("CometTrackingNodeProvider.react"),{trackingNode:m,children:a}):a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatVideoPlayerControls.react",["VideoPlayerControlsContainerOverlay.react","VideoPlayerControlsGroups.react","VideoPlayerFullscreenControl.react","VideoPlayerHooks","VideoPlayerPlaybackControl.react","VideoPlayerPlaybackTimer.react","VideoPlayerScrubber.react","VideoPlayerVolumeControl.react","react","useVideoPlayerBigPlayButtonOverlay","useVideoPlayerDefaultControlsVisibility"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||d("react");function k(a){a=a.children;return j.jsx("span",{className:"x12y6twl x1g0ag68",children:a})}k.displayName=k.name+" [from "+f.id+"]";function a(a){a=a.hideExpandButton;var b=c("useVideoPlayerDefaultControlsVisibility")(),e=b.isControlsVisible;b=b.onUserInteraction;var f=(i||(i=d("VideoPlayerHooks"))).usePaused();f=c("useVideoPlayerBigPlayButtonOverlay")({forceVisible:f});var g=f.bigPlayButtonElement;f=f.bigPlayButtonIsVisible;var h=i.useIsFullscreen();e=e&&!f;f=j.jsx(c("VideoPlayerControlsContainerOverlay.react"),{isVisible:e,children:h?j.jsxs(j.Fragment,{children:[j.jsxs(d("VideoPlayerControlsGroups.react").Contracted,{children:[j.jsx(c("VideoPlayerPlaybackControl.react"),{}),j.jsx(c("VideoPlayerPlaybackTimer.react"),{})]}),j.jsx(d("VideoPlayerControlsGroups.react").Expanded,{children:j.jsx(c("VideoPlayerScrubber.react"),{onUserInteraction:b})}),j.jsxs(d("VideoPlayerControlsGroups.react").Contracted,{children:[j.jsx(c("VideoPlayerFullscreenControl.react"),{onUserInteraction:b}),j.jsx(c("VideoPlayerVolumeControl.react"),{onUserInteraction:b})]})]}):j.jsxs(j.Fragment,{children:[j.jsx(d("VideoPlayerControlsGroups.react").Contracted,{children:j.jsx(k,{children:j.jsx(c("VideoPlayerPlaybackControl.react"),{})})}),j.jsx(d("VideoPlayerControlsGroups.react").Expanded,{children:j.jsx(c("VideoPlayerScrubber.react"),{onUserInteraction:b})}),j.jsxs(d("VideoPlayerControlsGroups.react").Contracted,{children:[a?null:j.jsx(k,{children:j.jsx(c("VideoPlayerFullscreenControl.react"),{onUserInteraction:b})}),j.jsx(k,{children:j.jsx(c("VideoPlayerVolumeControl.react"),{onUserInteraction:b})})]})]})});return j.jsxs(j.Fragment,{children:[g,f]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWVideoPlayerControllerContext.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=a.createContext({ref:{current:null}});g["default"]=b}),98);
__d("MWChatVideoPlayer.react",["CometProductAttribution","GraphQLVideoAutoplayGatingResult","MWChatVideoAutoplaySettingContext","MWChatVideoPlayerControls.react","MWVideoPlayerControllerContext.react","VideoPlayerDefaultControls.react","VideoPlayerHooks","VideoPlayerInteractionOverlay.react","VideoPlayerProgressiveImplementationData","VideoPlayerProgressiveImplementationV2.react","VideoPlayerSurface.react","VideoPlayerX.react","computeAspectRatio","getVideoPlayerAutoplayProps","gkx","react","useVideoPlayerClickToPauseInteraction","useVideoPlayerClickToPlayInteraction"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||(h=d("react"));b=h;var k=b.useCallback,l=b.useContext,m=b.useEffect,n=b.useRef,o={link_context:null,navChainContent:null,rootName:"MWChatMediaRoot.react",tap_point:"unexpected",tracePolicy:"comet.sharedmediaviewer.media",trackingNodes:null};function p(a){var b=a.controls,e=a.hideExpandButton;a=a.shouldForcePauseOnClick;var f=c("useVideoPlayerClickToPlayInteraction")({shouldUnmute:!0}),g=c("useVideoPlayerClickToPauseInteraction")(),h=(i||(i=d("VideoPlayerHooks"))).usePaused();h=h&&!a?f:g;return j.jsxs(j.Fragment,{children:[j.jsx(d("VideoPlayerInteractionOverlay.react").VideoPlayerInteractionOverlay,{pressInteraction:h}),q(b,e)]})}p.displayName=p.name+" [from "+f.id+"]";var q=function(a,b){switch(a){case"mwchat":return j.jsx(c("MWChatVideoPlayerControls.react"),{hideExpandButton:b===!0});case"default":return j.jsx(c("VideoPlayerDefaultControls.react"),{});case"none":return null;default:return null}};function r(a){a=a.children;var b=(i||(i=d("VideoPlayerHooks"))).useController(),e=l(c("MWVideoPlayerControllerContext.react"));m(function(){e.ref.current=b;return function(){e.ref.current=null}},[e,b]);return a}r.displayName=r.name+" [from "+f.id+"]";function a(a){var b=a.autoPlaySetting,e=a.controls,f=a.fbid,g=a.hdSrc,h=a.hideExpandButton,i=a.initialForceHD,k=a.mediaRenderQpl,l=a.originalHeight,m=a.originalWidth,n=a.sdSrc,t=a.shouldForcePauseOnClick,u=a.startTimestamp;a=a.volumeSetting;var v=d("MWChatVideoAutoplaySettingContext").useMWChatVideoAutoplaySetting();i=d("VideoPlayerProgressiveImplementationData").makeProgressiveImplementationData({hdSrc:g,hdSrcPreferred:(g=i)!=null?g:!1,isExternalMedia:!1,sdSrc:n});if(i instanceof Error)return null;g=[{Component:c("VideoPlayerProgressiveImplementationV2.react"),data:i,typename:"VideoPlayerProgressiveImplementation"}];i=c("getVideoPlayerAutoplayProps")(d("GraphQLVideoAutoplayGatingResult").makeGraphQLVideoAutoplayGatingResult("unknown",(n=b)!=null?n:v,!0),c("gkx")("24123")?"respect_user_settings":"do_not_autoplay",null);b=c("computeAspectRatio")(m,l);return j.createElement(c("VideoPlayerX.react"),babelHelpers["extends"]({},i,{implementations:g,key:f,loopCount:-1,playerOriginOverride:"messaging",portalingEnabled:!1,productAttribution:{v2:[d("CometProductAttribution").getProductAttributionEntryV2(o)]},startTimestamp:u,subOrigin:"messenger_thread",videoFBID:f,videoPixelsAspectRatio:b,volumeSetting:a}),j.jsxs(c("VideoPlayerSurface.react"),{children:[j.jsx(s,{mediaRenderQpl:k}),j.jsx(r,{children:c("gkx")("721")?j.jsx(p,{controls:e,hideExpandButton:h,shouldForcePauseOnClick:t}):q(e,h)})]}))}a.displayName=a.name+" [from "+f.id+"]";function s(a){var b=a.mediaRenderQpl,c=(i||(i=d("VideoPlayerHooks"))).useController(),e=n(),f=k(function(){var a=c.getCurrentState();if(a.error!=null){var d=a.error.errorName,f=a.error.errorType;b==null?void 0:b.endFail("load-video-error",{string:{video_error_name:d,video_error_type:f}});(d=e.current)==null?void 0:d.remove()}if(a.duration>0){b==null?void 0:b.endSuccess();(f=e.current)==null?void 0:f.remove()}},[b,c]);m(function(){e.current=c.subscribe(function(){f()});f();return function(){var a;(a=e.current)==null?void 0:a.remove()}},[f,c]);return null}s.displayName=s.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWMediaRenderQplUtils",["E2EELinkPreviewXMADataType","I64","LSBitFlag","LSIntEnum","LSMessageContentType","LSMessagingInitiatingSource","LSXmaContentType","MessagingAttachmentType","MessagingThreadType","QPLUserFlow","Random","objectEntries","performanceAbsoluteNow","qpl","react","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=i||d("react"),m=l.useEffect,n=l.useLayoutEffect,o=l.useMemo,p=l.useRef,q=c("qpl")._(25302828,"2195"),r=1e3*10,s=500,t=c("objectEntries")(c("LSMessageContentType")).reduce(function(a,b){var c=b[0];b=b[1];a.set(b,c);return a},new Map());function a(a){return u(a.displayedContentTypes)}function u(a){if(d("LSBitFlag").has((j||(j=d("LSIntEnum"))).ofNumber(1024),a)){var b;return(b=t.get(1024))!=null?b:"UNKNOWN"}return(b=t.get((k||(k=d("I64"))).to_float(a)))!=null?b:"UNKNOWN"}function v(a){var b;if((k||(k=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE)))b=(j||(j=d("LSIntEnum"))).ofNumber(16384);else if((k||(k=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE)))b=(j||(j=d("LSIntEnum"))).ofNumber(2);else if((k||(k=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)))b=(j||(j=d("LSIntEnum"))).ofNumber(2);else if((k||(k=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO)))b=(j||(j=d("LSIntEnum"))).ofNumber(4);else if((k||(k=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE)))b=(j||(j=d("LSIntEnum"))).ofNumber(64);else if((k||(k=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE)))b=(j||(j=d("LSIntEnum"))).ofNumber(64);else if((k||(k=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA)))b=(j||(j=d("LSIntEnum"))).ofNumber(1024);else return"UNKNOWN";return u(b)}var w=c("objectEntries")(c("MessagingAttachmentType")).reduce(function(a,b){var c=b[0];b=b[1];a.set(b,c);return a},new Map());function b(a){return x(a.attachmentType)}function x(a){return(a=w.get((k||(k=d("I64"))).to_float(a)))!=null?a:"UNKNOWN"}var y=c("objectEntries")(c("MessagingThreadType")).reduce(function(a,b){var c=b[0];b=b[1];a.set(b,c);return a},new Map());function e(a){a=a.threadType;return z(a)}function z(a){return(a=y.get((k||(k=d("I64"))).to_float(a)))!=null?a:"UNKNOWN"}var A=c("objectEntries")(c("LSXmaContentType")).reduce(function(a,b){var c=b[0];b=b[1];a.set(b,c);return a},new Map());function B(a){return(a=A.get((k||(k=d("I64"))).to_float(a)))!=null?a:"UNKNOWN"}var C=c("objectEntries")(c("LSMessagingInitiatingSource")).reduce(function(a,b){var c=b[0];b=b[1];a.set(b,c);return a},new Map());function f(a){return a!=null?(a=C.get((k||(k=d("I64"))).to_float(a)))!=null?a:"UNKNOWN":"UNKNOWN"}var D=c("objectEntries")(c("E2EELinkPreviewXMADataType")).reduce(function(a,b){var c=b[0];b=b[1];a.set(b,c);return a},new Map());function E(a){return(a=D.get((k||(k=d("I64"))).to_float(a)))!=null?a:"UNKNOWN"}function F(a,b,d,e){var f=(h||(h=c("performanceAbsoluteNow")))();return{addAnnotations:function(d){c("QPLUserFlow").addAnnotations(a,d,{instanceKey:b})},addPoint:function(d,e){e&&c("QPLUserFlow").addAnnotations(a,e,{instanceKey:b}),c("QPLUserFlow").addPoint(a,d,{instanceKey:b})},endCancel:function(e){d!=null&&(d.current=!0);var f=(h||(h=c("performanceAbsoluteNow")))();c("setTimeout")(function(){c("QPLUserFlow").endCancel(a,{cancelReason:e,instanceKey:b,timestamp:f})},s)},endFail:function(e,f){d!=null&&(d.current=!0);var g=(h||(h=c("performanceAbsoluteNow")))();c("setTimeout")(function(){c("QPLUserFlow").endFailure(a,e,{annotations:f,instanceKey:b,timestamp:g})},s)},endSuccess:function(e){d!=null&&(d.current=!0);var f=(h||(h=c("performanceAbsoluteNow")))();c("setTimeout")(function(){c("QPLUserFlow").endSuccess(a,{annotations:e,instanceKey:b,timestamp:f})},s)},getInstanceKey:function(){return b},start:function(){c("QPLUserFlow").start(q,{annotations:e,cancelOnUnload:!0,instanceKey:b,timeoutInMs:r,timestamp:f})}}}function G(a,b,c){var d=a.attachmentType,e=p(!1),f=o(function(){var f=H(),g={string:{attachment_type:x(d),content_type:v(d),entry_point:c,thread_type:z(b),transport_key:a.transportKey,xma_content_type:a.xmaContentType!=null?B(a.xmaContentType):void 0}};return babelHelpers["extends"]({},F(q,f,e,g))},[a.messageId]);n(function(){f==null?void 0:f.start()},[f]);m(function(){return function(){e.current===!1&&(f==null?void 0:f.getInstanceKey())!=null&&(f==null?void 0:f.endCancel(706))}},[f]);return f}function H(){return Date.now()+Math.round(d("Random").random()*1e4)}g.event=q;g.QPL_TIMEOUT=r;g.QPL_END_DELAY_MS=s;g.getMessageContentTypeString=a;g.getMessageContentTypeStringFromEnum=u;g.deriveMessageContentTypeStringFromAttachmentTypeLessAccurate=v;g.getAttachmentTypeString=b;g.getAttachmentTypeStringFromEnum=x;g.getThreadTypeString=e;g.getThreadTypeStringFromEnum=z;g.getXmaContentTypeStringFromEnum=B;g.getMessagingInitiationSourceStringFromEnum=f;g.getE2EELinkPreviewXMADataTypeStringFromEnum=E;g.createQplFlowCommon=F;g.useCommonMediaRenderQplForAttachment=G}),98);
__d("MWV2MediaViewerContainer.react",["MessengerBlurpleLogoSvg.react","UNTRANSLATED_STRING_FIXME","XMessengerDotComCometRootControllerRouteBuilder","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=a.actions,d=a.children;a=a.shouldShowMessengerLogo;return i.jsxs("div",{className:"x1qjc9v5 xal61yo x9f619 x78zum5 xdt5ytf x1iyjqo2 x5yr21d x6ikm8r x10wlt62 x1n2onr6 x87ps6o x1uvtmcs","data-testid":void 0,children:[d,i.jsx("div",{className:"x10l6tqk x16q8cke x1tk7jg1",children:((d=a)!=null?d:!1)?i.jsx("a",{"aria-label":c("UNTRANSLATED_STRING_FIXME")("Messenger"),href:c("XMessengerDotComCometRootControllerRouteBuilder").buildURL({}),children:i.jsx(c("MessengerBlurpleLogoSvg.react"),{height:"40",width:"40"})}):null}),i.jsx("div",{className:"x92rtbv x10l6tqk x1tk7jg1",children:b})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("XComposerPhotoUploaderImmediate",["Promise","XComposerPhotoUploader","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h;a={load:function(){return(h||(h=b("Promise"))).resolve(c("XComposerPhotoUploader"))},preload:c("emptyFunction")};g["default"]=a}),98);
__d("acceptMAWMessageRequest",["I64","LSAddMessengerContactStoredProcedure","LSFactory","LSOptimisticAcceptMessageRequestStoredProcedure","MAWUpdateLSThreadCapabilities","Promise","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,e,g,j){if(!j||g==null)return;var k=g[1],l=babelHelpers["extends"]({},k,{contactViewerRelationship:(i||(i=d("I64"))).of_string("2")});c("promiseDone")(a.runInTransaction(function(a){return(h||(h=b("Promise"))).all([a.contacts.upsert([k.id],l),c("LSAddMessengerContactStoredProcedure")(c("LSFactory")(a),{contactId:k.id}),d("MAWUpdateLSThreadCapabilities").updateNonMessageRequestThreadTxn(a,e.threadKey),c("LSOptimisticAcceptMessageRequestStoredProcedure")(c("LSFactory")(a),{threadKey:e.threadKey})])},"readwrite",void 0,void 0,f.id+":37"))}g["default"]=a}),98);